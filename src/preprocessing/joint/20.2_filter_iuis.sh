#!/bin/bash 
#SBATCH --nodes 1
#SBATCH --ntasks 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 12G
#SBATCH --time 03:00:00
#SBATCH --job-name=filtervep
#SBATCH --output=./log/vep/filter_vep_IEI_gene_%J.out
#SBATCH --error=./log/vep/filter_vep_IEI_gene_%J.err
#SBATCH --comment="scitas_cost"

# CONDA ENV
# activate before submission
# conda activate vep

echo "START AT $(date)"
set -e

# Master variables
source ./variables.txt

# Path
INPUT_DIR="${WORK_DIR}/pre_annotation_output"
OUTPUT_DIR="${WORK_DIR}/annotation"

module load intel # jed

# Prep iuis gene list
#	cat ~/web/tools/genomic_tools/iuis_iei_table/data/10875_2022_1289_MOESM2_ESM_DLcleaned.tsv | cut -f2-3 > ~/Desktop/iuis_gene_list.txt
#	cp iuis_gene_list.txt iuis_gene_list_manual_clean.txt
# Print genes to single line
#  cat iuis_gene_list.txt | cut -f1 | tr  '\n' ,  > iuis_gene_list_line.txt
# Gene list.

# find variants in a list of gene names

filter_vep \
-i ${OUTPUT_DIR}/bcftools_gatk_norm_maf01.recode_vep_conda_impact.vcf \
-o ${OUTPUT_DIR}/bcftools_gatk_norm_maf01.recode_vep_conda_impact_iuis.vcf \
--force_overwrite \
--filter "SYMBOL in CD3D,CD3E,CD3Z,CORO1A,IL2RG,IL7R,ITPKB,JAK3,LAT,PAX1,PTPRC,SLP76,ADA,AK2,DCLRE1C,LIG4,NHEJ1,PRKDC,RAC2,RAG1,RAG2,B2M,BCL10,CARD11,CD3G,CD40,CD40LG,CD8A,CHUK,CIITA,COPG1,DOCK2,DOCK8,FCHO1,ICOS,ICOSLG,IKBKB,IKZF1,IKZF2,IKZF2,IL21,IL21R,ITK,LCK,MALT1,MAN2B2,MAP3K14,MSN,POLD1,POLD2,REL,RELA,RELB,RFX5,RFXANK,RFXAP,RHOH,SASH3,STK4,TAP1,TAP2,TAPBP,TFRC,TNFRSF4,TRAC,ZAP70,ZAP70,ARPC1B,WAS,WIPF1,ATM,BLM,CDCA7,DNMT3B,GINS1,HELLS,LIG1,MCM10,MCM4,NBS1,NSMCE3,PMS2,POLA1,POLE1,POLE2,RNF168,ZBTB24,11q23del,CHD7,Del10p13-p14,FOXN1,FOXN1,Large,SEMA3E,TBX1,EXTL3,MYSM1,RMRP,RNU4ATAC,SMARCAL1,CARD11,ERBB21P,IL6R,IL6ST,IL6ST,PGM3,SPINK5,STAT3,TGFBR1,TGFBR2,ZNF341,MTHFD1,SLC46A1,TCN2,IKBKB,IKBKG,NFKBIA,CRACR2A,ORAI1,STIM1,BCL11B,CCBE1,CD28,DIAPH1,EPG5,FAT4,IKZF3,KDM6A,KMT2A,KMT2D,NFE2L2,PNP,RBCK1,RNF31,SKIV2L,SP110,STAT5B,STAT5B,TTC37,TTC7A,ERCC6L2,BLNK,BTK,CD79A,CD79B,FNIP1,IGHM,IGLL1,PIK3CD,PIK3R1,SLC39A7,SPI1,TCF3,TCF3,TOP2B,ARHGEF1,ATP6AP1,CD19,CD20,CD21,CD81,IKZF1,IRF2BP2,MOGS,NFKB1,NFKB2,PIK3CD,PIK3CG,PIK3R1,POU2AF1,PTEN,RAC2,SEC61A1,SH3KBP1,TNFRSF13B,TNFRSF13C,TNFSF12,TRNT1,AICDA,AICDA,CTNNBL1,INO80,MSH6,TNFSF13,UNG,CARD11,IGKC,FAAP24,PRF1,RHOG,SLC7A7,STX11,STXBP2,UNC13D,AP3B1,AP3D1,LYST,RAB27A,BACH2,CTLA4,DEF6,FERMT1,FOXP3,IL2RA,IL2RB,LRBA,IKZF1,STAT3,AIRE,AIRE,ITCH,JAK1,PDCD1,PEPD,SOCS1,TPP2,ELF4,IL10,IL10RA,IL10RB,NFAT5,RIPK1,TGFB1,CASP10,CASP8,FADD,TNFRSF6,TNFRSF6,TNFSF6,CARMIL2,CD27,CD70,CTPS1,MAGT1,PRKCD,RASGRP1,SH2D1A,TET2,TNFRSF9,XIAP,CEBPE,CLPB,CSF3R,CXCR2,DNAJC21,EFL1,ELANE,G6PC3,G6PT1,GFI1,HAX1,HYOU1,JAGN1,LAMTOR2,SBDS,SMARCD2,SRP54,TAZ,USB1,VPS13B,VPS45,WAS,ACTB,CEBPE,CFTR,CTSC,FERMT3,FPR1,ITGB2,MKL1,RAC2,SLC35C1,WDR1,CYBA,CYBB,NCF1,NCF2,NCF4,CYBC1,G6PD,CSF2RA,CSF2RB,GATA2,CYBB,IFNG,IFNGR1,IFNGR1,IFNGR2,IL12BÂ ,IL12RB1,IL12RB2,IL23R,IRF8,IRF8,ISG15,JAK1,RORC,SPPL2A,STAT1,TBX21,TYK2,TYK2,CIB1,CXCR4,TMC6,TMC8,FCGR3A,IFIH1,IFNAR1,IFNAR2,IRF7,IRF9,NOS2,POLR3A,POLR3C,POLR3F,STAT1,STAT2,TLR7,ZNFX1,ATG4A,DBR1,IRF3,MAP1LC3B2,SNORA31,TBK1,TICAM1,TLR3,TLR3,TRAF3,UNC93B1,CARD9,IL17F,IL17RA,IL17RC,MAPK8,STAT1,TRAF3IP2,IRAK1,IRAK4,MYD88,TIRAP,TLR8,APOL1,CLCN7,HMOX,NBAS,NCSTN,OSTM1,PLEKHM1,PSEN,PSENEN,RANBP2,RPSA,SNX10,TCIRG1,TNFRSF11A,TNFSF11,IL18BP,IRF4,ACP5,ADA2,ADAR1,ATAD3A,C2orf69,CDC42,DNASE1L3,DNASE2,IFIH1,LSM11,OAS1,RNASEH2A,RNASEH2B,RNASEH2C,RNU7-1,SAMHD1,STAT2,TMEM173,TMEM173,TREX1,TREX1,USP18,MEFV,MEFV,MVK,NLRC4,NLRP1,NLRP1,NLRP12,NLRP3,NLRP3,NLRP3,RIPK1,ADAM17,ALPI,AP1S3,CARD14,COPA,HAVCR2,HCK,IL1RN,IL36RN,LPIN2,NCKAPIL,NOD2,OTULIN,PLCG2,PSMB8,PSMB8,PSMB9,PSMG2,PSTPIP1,SH3BP2,SLC29A3,SYK,TNFAIP3,IKBKG,TBK1,TNFRSF1A,TRIM22,C1QA,C1QB,C1QC,C1R,C1R,C1S,C1S,C2,C3,C3,C4A,C4B,C5,C6,C7,C8A,C8B,C8G,C9,CD46,CD55,CD59,CFB,CFB,CFD,CFH,CFH,CFHR1,CFHR1,CFI,CFP,FCN3,MASP2,SERPING1,THBD,ACD,BRCA1,BRCA2,BRIP1,CTC1,DKC1,ERCC4,FANCA,FANCB,FANCC,FANCD2,FANCE,FANCF,FANCI,FANCL,FANCM,MAD2L2,MECOM,NOLA2,NOLA3,PALB2,PARN,RAD51,RAD51C,RFWD3,RTEL1,RTEL1,SAMD9,SAMD9L,SLX4,SRP72,STN1,TERC,TERT,TERT,TINF2,TP53,UBE2T,WRAP53,XRCC2,XRCC9"

echo "END AT $(date)"
